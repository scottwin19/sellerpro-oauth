  <!DOCTYPE html>
  <html lang="en">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>SellerPro OAuth Handler</title>
      <style>
          body {
              font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
              max-width: 700px;
              margin: 50px auto;
              padding: 20px;
              background: #f5f5f5;
          }
          .container {
              background: white;
              padding: 40px;
              border-radius: 10px;
              box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          }
          .success {
              color: #28a745;
              background: #d4edda;
              padding: 15px;
              border-radius: 5px;
              margin: 20px 0;
          }
          .error {
              color: #dc3545;
              background: #f8d7da;
              padding: 15px;
              border-radius: 5px;
              margin: 20px 0;
          }
          .loading { color: #007bff; }
          .code {
              background: #f8f9fa;
              padding: 15px;
              border-radius: 5px;
              margin: 20px 0;
              font-family: monospace;
              word-break: break-all;
              border: 1px solid #dee2e6;
          }
          .copy-btn {
              background: #007bff;
              color: white;
              border: none;
              padding: 10px 20px;
              border-radius: 5px;
              cursor: pointer;
              margin: 10px 0;
          }
          .copy-btn:hover {
              background: #0056b3;
          }
          .instructions {
              background: #e7f3ff;
              padding: 15px;
              border-radius: 5px;
              margin: 20px 0;
          }
      </style>
  </head>
  <body>
      <div class="container">
          <h1>üéâ SellerPro OAuth Handler</h1>
          <div id="status" class="loading">Processing eBay authorization...</div>
          <div id="details"></div>

          <div id="success-section" style="display: none;">
              <div class="success">
                  <h3>‚úÖ Authorization Successful!</h3>
                  <p>Your eBay authorization code has been received.</p>
              </div>

              <h4>üìã Authorization Code:</h4>
              <div class="code" id="auth-code"></div>

              <button class="copy-btn" onclick="copyCode()">üìã Copy Authorization Code</button>

              <div class="instructions">
                  <h4>üéØ Next Steps:</h4>
                  <ol>
                      <li><strong>Copy the authorization code above</strong></li>
                      <li><strong>Go back to your terminal/Claude Code</strong></li>
                      <li><strong>Paste the code</strong> to exchange it for access tokens</li>
                      <li><strong>Your eBay integration will be working!</strong></li>
                  </ol>
              </div>
          </div>

          <div id="error-section" style="display: none;">
              <div class="error">
                  <h3>‚ùå Authorization Error</h3>
                  <div id="error-details"></div>
              </div>
          </div>
      </div>

      <script>
          function getUrlParams() {
              const params = new URLSearchParams(window.location.search);
              const hash = window.location.hash.substring(1);
              const hashParams = new URLSearchParams(hash);

              return {
                  code: params.get('code') || hashParams.get('code'),
                  state: params.get('state') || hashParams.get('state'),
                  error: params.get('error') || hashParams.get('error'),
                  error_description: params.get('error_description') || hashParams.get('error_description')
              };
          }

          function copyCode() {
              const codeText = document.getElementById('auth-code').textContent;
              navigator.clipboard.writeText(codeText).then(() => {
                  const btn = document.querySelector('.copy-btn');
                  const originalText = btn.textContent;
                  btn.textContent = '‚úÖ Copied!';
                  setTimeout(() => {
                      btn.textContent = originalText;
                  }, 2000);
              }).catch(() => {
                  // Fallback for older browsers
                  const textArea = document.createElement('textarea');
                  textArea.value = codeText;
                  document.body.appendChild(textArea);
                  textArea.select();
                  document.execCommand('copy');
                  document.body.removeChild(textArea);

                  const btn = document.querySelector('.copy-btn');
                  const originalText = btn.textContent;
                  btn.textContent = '‚úÖ Copied!';
                  setTimeout(() => {
                      btn.textContent = originalText;
                  }, 2000);
              });
          }

          function handleOAuth() {
              const params = getUrlParams();
              const statusEl = document.getElementById('status');
              const detailsEl = document.getElementById('details');
              const successSection = document.getElementById('success-section');
              const errorSection = document.getElementById('error-section');

              if (params.error) {
                  statusEl.style.display = 'none';
                  errorSection.style.display = 'block';
                  document.getElementById('error-details').innerHTML = `
                      <p><strong>Error:</strong> ${params.error}</p>
                      <p><strong>Description:</strong> ${params.error_description || 'Unknown error'}</p>
                      <p>Please try the authorization process again.</p>
                  `;
                  return;
              }

              if (!params.code) {
                  statusEl.style.display = 'none';
                  errorSection.style.display = 'block';
                  document.getElementById('error-details').innerHTML = `
                      <p>No authorization code received from eBay.</p>
                      <p><strong>Debug Info:</strong> URL = ${window.location.href}</p>
                      <p>Please try the authorization process again.</p>
                  `;
                  return;
              }

              // Success! Show the authorization code
              statusEl.style.display = 'none';
              successSection.style.display = 'block';
              document.getElementById('auth-code').textContent = params.code;

              // Store in localStorage for reference
              localStorage.setItem('ebayAuthCode', params.code);
              localStorage.setItem('ebayAuthTimestamp', new Date().toISOString());
          }

          document.addEventListener('DOMContentLoaded', handleOAuth);
      </script>
  </body>
  </html>
